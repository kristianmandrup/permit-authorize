// Generated by LiveScript 1.2.0
(function(){
  var util, array, normalize, Debugger, RuleMixin, RuleAdder, RuleRegistrator, toString$ = {}.toString;
  util = require('../../util');
  array = util.array;
  normalize = util.normalize;
  Debugger = util.Debugger;
  RuleMixin = require('./rule_mixin');
  RuleAdder = require('./rule_adder');
  module.exports = RuleRegistrator = (function(){
    RuleRegistrator.displayName = 'RuleRegistrator';
    var prototype = RuleRegistrator.prototype, constructor = RuleRegistrator;
    importAll$(prototype, arguments[0]);
    importAll$(prototype, arguments[1]);
    function RuleRegistrator(container, debugging){
      this.container = container;
      this.debugging = debugging != null ? debugging : true;
      this._validate();
      this;
    }
    prototype._type = 'RuleRegistrator';
    prototype._validate = function(){
      if (toString$.call(this.container).slice(8, -1) !== 'Object') {
        throw Error("Container must be an object, was: " + this.container);
      }
    };
    prototype.register = function(act, actions, subjects){
      this.act = act;
      this.actions = actions;
      this.subjects = subjects;
      this.debug('register', this.act, this.actions, this.subjects);
      this.actContainer = this.containerFor(act);
      this.actions = normalize(this.actions);
      this.subjects = normalize(this.subjects);
      console.log('add em', this.act, this.actions, this.subjects);
      this.addActions();
      return this;
    };
    prototype.addActions = function(){
      var i$, ref$, len$, action, results$ = [];
      this.debug('add actions', this.actions);
      for (i$ = 0, len$ = (ref$ = this.actions).length; i$ < len$; ++i$) {
        action = ref$[i$];
        results$.push(this.add(action));
      }
      return results$;
    };
    prototype.add = function(action){
      return this.adder().add(action);
    };
    prototype.adder = function(){
      return new RuleAdder(this.actContainer, this.subjects, this.debugging);
    };
    return RuleRegistrator;
  }(RuleMixin, Debugger));
  function importAll$(obj, src){
    for (var key in src) obj[key] = src[key];
    return obj;
  }
}).call(this);
